% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pro-adjust.R
\name{adjust_protein}
\alias{adjust_protein}
\alias{adjust_protein.glyexp_experiment}
\alias{adjust_protein.default}
\title{Adjust Protein Expression}
\usage{
adjust_protein(exp, pro_expr_mat, method = c("ratio", "reg"))

\method{adjust_protein}{glyexp_experiment}(exp, pro_expr_mat, method = c("ratio", "reg"))

\method{adjust_protein}{default}(exp, pro_expr_mat, method = c("ratio", "reg"))
}
\arguments{
\item{exp}{A \code{\link[glyexp:experiment]{glyexp::experiment()}} object with "glycoproteomics" type.}

\item{pro_expr_mat}{A matrix of protein expression.
Columns are samples, rows are uniprot protein accessions.}

\item{method}{The method to use for protein adjustment.
Either "ratio" or "reg". Default is "ratio".}
}
\value{
A \code{\link[glyexp:experiment]{glyexp::experiment()}} object with adjusted protein expression.
}
\description{
This function adjusts the glycopeptide expression by the protein expression.
In another word, it "strips out" the protein expression from the glycopeptide expression,
so that the expression reflects the glycosylation status only.
}
\details{
For simplicity, glycopeptide expression is denoted as \code{GP},
and protein expression is denoted as \code{PRO}.
\subsection{"ratio" method}{

\code{GP-adj} = (\code{GP} / \code{PRO}) / (median(\code{GP}) / median(\code{PRO}))

The first part is to adjust glycopeptide expression by protein expression.
The second part is to rescale the expression to the original scale.
}

\subsection{"reg" method}{

Use linear regression to remove the protein expression from the glycopeptide expression.
Both glycopeptide and protein expression values are log2-transformed (with +1 to avoid log(0))
before fitting the linear model: log2(GP+1) ~ log2(PRO+1).
The residuals represent the glycosylation-specific signal and are converted back to the
original scale using 2^residuals, ensuring all adjusted values are positive.

In both methods, only glycoproteins identified in both \code{exp} and \code{pro_expr_mat} will be retained.
}
}
