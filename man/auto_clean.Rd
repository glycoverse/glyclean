% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/auto-clean.R
\name{auto_clean}
\alias{auto_clean}
\alias{auto_clean.glyexp_experiment}
\alias{auto_clean.default}
\title{Automatic Data Preprocessing}
\usage{
auto_clean(exp)

\method{auto_clean}{glyexp_experiment}(exp)

\method{auto_clean}{default}(exp)
}
\arguments{
\item{exp}{A \code{\link[glyexp:experiment]{glyexp::experiment()}} containing glycoproteomics or
glycomics data.}
}
\value{
A modified \code{glyexp::experiment()} object.
}
\description{
Perform automatic data preprocessing on glycoproteomics or glycomics data.
This function applies a standardized preprocessing pipeline that includes
normalization, missing value handling, imputation, aggregation (for
glycoproteomics data), and batch effect correction.
}
\details{
The preprocessing pipeline differs based on the experiment type:

For Glycoproteomics Data:
\enumerate{
\item Median normalization
\item Remove variables with \\>50\% missing values
\item Automatic imputation (method depends on sample size)
\item Automatic aggregation (gfs level if structure available, otherwise gf level)
\item Final median normalization
\item Intelligent batch effect correction
}

For Glycomics Data:
\enumerate{
\item Median quotient normalization
\item Remove variables with \\>50\% missing values
\item Automatic imputation (method depends on sample size)
\item Total area normalization
\item Intelligent batch effect correction
}

Automatic Imputation Strategy:
\itemize{
\item <=30 samples: Sample minimum imputation
\item 31-100 samples: Minimum probability imputation
\item \\>100 samples: MissForest imputation
}

Automatic Aggregation Strategy (Glycoproteomics Only):
\itemize{
\item If \code{glycan_structure} column exists: Aggregate to "gfs" level
\item If no \code{glycan_structure} column: Aggregate to "gf" level
}

Intelligent Batch Effect Correction:

The function first detects batch effects using ANOVA.
Batch correction is only performed if more than 10\% of variables
show significant batch effects (p < 0.05).
If a \code{group} column exists in the sample information,
it will be used as a covariate in both detection and correction
to preserve biological variation.
The batches are defined by the \code{batch} column in the sample information tibble.
}
\examples{
\dontrun{
# For glycoproteomics data
cleaned_exp <- auto_clean(glycoprot_exp)

# For glycomics data
cleaned_exp <- auto_clean(glycomics_exp)
}

}
\seealso{
\code{\link[=aggregate]{aggregate()}}, \code{\link[=normalize_median]{normalize_median()}}, \code{\link[=remove_rare]{remove_rare()}},
\code{\link[=impute_sample_min]{impute_sample_min()}}, \code{\link[=impute_min_prob]{impute_min_prob()}}, \code{\link[=impute_miss_forest]{impute_miss_forest()}},
\code{\link[=correct_batch_effect]{correct_batch_effect()}}
}
