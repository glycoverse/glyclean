<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Get Started with glyclean ‚Ä¢ glyclean</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Get Started with glyclean">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">glyclean</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.12.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/glyclean.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Get Started with glyclean</h1>
            
      

      <div class="d-none name"><code>glyclean.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="welcome-to-the-wild-world-of-data-preprocessing">Welcome to the Wild World of Data Preprocessing! üß¨<a class="anchor" aria-label="anchor" href="#welcome-to-the-wild-world-of-data-preprocessing"></a>
</h2>
<p>Every omics data analysis journey begins with the same challenge:
taming your raw data. Think of it like preparing ingredients before
cooking a gourmet meal ‚Äì you need to wash, chop, and season everything
just right. In the glycomics and glycoproteomics world, this means
normalization, missing value handling, and batch effect correction.</p>
<p>Meet <code>glyclean</code> ‚Äì your Swiss Army knife for
glycoproteomics and glycomics data preprocessing! This package provides
a comprehensive toolkit that takes the guesswork out of data cleaning,
with specialized methods designed specifically for the unique challenges
of glycan analysis.</p>
<p><strong>Important Note:</strong> This package is primarily designed
for <code><a href="https://glycoverse.github.io/glyexp/reference/experiment.html" class="external-link">glyexp::experiment()</a></code> objects. If you‚Äôre new to this
data structure, we highly recommend checking out <a href="https://glycoverse.github.io/glyexp/articles/glyexp.html" class="external-link">its
introduction</a> first. We‚Äôll also be using the <a href="https://github.com/glycoverse/glyread" class="external-link">glyread</a> package to load
our data ‚Äì it‚Äôs the go-to tool in the <code>glycoverse</code>
ecosystem.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://glycoverse.github.io/glyclean/">glyclean</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'glyclean'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     aggregate</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://glycoverse.github.io/glyexp/" class="external-link">glyexp</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://glycoverse.github.io/glyrepr/" class="external-link">glyrepr</a></span><span class="op">)</span>  <span class="co"># for printing glycan compositions and structures</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="meet-our-star-player-real-glycoproteomics-data">Meet Our Star Player: Real Glycoproteomics Data üåü<a class="anchor" aria-label="anchor" href="#meet-our-star-player-real-glycoproteomics-data"></a>
</h2>
<p>Let‚Äôs dive in with a real-world dataset that will showcase what
<code>glyclean</code> can do. We‚Äôll use
<code><a href="https://glycoverse.github.io/glyread/reference/read_pglyco3_pglycoquant.html" class="external-link">glyread::read_pglyco3_pglycoquant()</a></code> to load our data into a
proper <code><a href="https://glycoverse.github.io/glyexp/reference/experiment.html" class="external-link">glyexp::experiment()</a></code> object.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exp</span> <span class="op">&lt;-</span> <span class="va">real_experiment</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://glycoverse.github.io/glyexp/reference/mutate_obs.html" class="external-link">mutate_obs</a></span><span class="op">(</span>batch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">exp</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">‚îÄ‚îÄ</span> <span style="font-weight: bold;">Glycoproteomics Experiment</span> <span style="color: #00BBBB;">‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">‚Ñπ</span> Expression matrix: <span style="color: #0000BB;">12</span> samples, <span style="color: #0000BB;">4262</span> variables</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">‚Ñπ</span> Sample information fields: <span style="color: #00BB00;">group</span> <span style="color: #0000BB;">&lt;fct&gt;</span>, <span style="color: #00BB00;">batch</span> <span style="color: #0000BB;">&lt;fct&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">‚Ñπ</span> Variable information fields: <span style="color: #00BB00;">peptide</span> <span style="color: #0000BB;">&lt;chr&gt;</span>, <span style="color: #00BB00;">peptide_site</span> <span style="color: #0000BB;">&lt;int&gt;</span>, <span style="color: #00BB00;">protein</span> <span style="color: #0000BB;">&lt;chr&gt;</span>, <span style="color: #00BB00;">protein_site</span> <span style="color: #0000BB;">&lt;int&gt;</span>, <span style="color: #00BB00;">gene</span> <span style="color: #0000BB;">&lt;chr&gt;</span>, <span style="color: #00BB00;">glycan_composition</span> <span style="color: #0000BB;">&lt;comp&gt;</span>, <span style="color: #00BB00;">glycan_structure</span> <span style="color: #0000BB;">&lt;struct&gt;</span></span></span></code></pre></div>
<p>Let‚Äôs peek under the hood and see what we‚Äôre working with:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://glycoverse.github.io/glyexp/reference/get_var_info.html" class="external-link">get_var_info</a></span><span class="op">(</span><span class="va">exp</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4,262 √ó 8</span></span></span>
<span><span class="co">#&gt;    variable   peptide peptide_site protein protein_site gene  glycan_composition</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;comp&gt;</span>            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> P08185-N1‚Ä¶ NKTQGK             1 P08185           176 SERP‚Ä¶ <span style="color: #000000;">Hex</span>(5)<span style="color: #000000;">HexNAc</span>(4)<span style="color: #000000;">Ne</span>‚Ä¶</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> P04196-N3‚Ä¶ HSHNNN‚Ä¶            5 P04196           344 HRG   <span style="color: #000000;">Hex</span>(5)<span style="color: #000000;">HexNAc</span>(4)<span style="color: #000000;">Ne</span>‚Ä¶</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> P04196-N3‚Ä¶ HSHNNN‚Ä¶            5 P04196           344 HRG   <span style="color: #000000;">Hex</span>(5)<span style="color: #000000;">HexNAc</span>(4)   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> P04196-N3‚Ä¶ HSHNNN‚Ä¶            5 P04196           344 HRG   <span style="color: #000000;">Hex</span>(5)<span style="color: #000000;">HexNAc</span>(4)<span style="color: #000000;">Ne</span>‚Ä¶</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> P10909-N2‚Ä¶ HNSTGC‚Ä¶            2 P10909           291 CLU   <span style="color: #000000;">Hex</span>(6)<span style="color: #000000;">HexNAc</span>(5)   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> P04196-N3‚Ä¶ HSHNNN‚Ä¶            5 P04196           344 HRG   <span style="color: #000000;">Hex</span>(5)<span style="color: #000000;">HexNAc</span>(4)<span style="color: #000000;">Ne</span>‚Ä¶</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> P04196-N3‚Ä¶ HSHNNN‚Ä¶            6 P04196           345 HRG   <span style="color: #000000;">Hex</span>(5)<span style="color: #000000;">HexNAc</span>(4)   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> P04196-N3‚Ä¶ HSHNNN‚Ä¶            5 P04196           344 HRG   <span style="color: #000000;">Hex</span>(5)<span style="color: #000000;">HexNAc</span>(4)<span style="color: #000000;">dH</span>‚Ä¶</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> P04196-N3‚Ä¶ HSHNNN‚Ä¶            5 P04196           344 HRG   <span style="color: #000000;">Hex</span>(4)<span style="color: #000000;">HexNAc</span>(3)   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> P04196-N3‚Ä¶ HSHNNN‚Ä¶            5 P04196           344 HRG   <span style="color: #000000;">Hex</span>(4)<span style="color: #000000;">HexNAc</span>(4)<span style="color: #000000;">Ne</span>‚Ä¶</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ‚Ñπ 4,252 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ‚Ñπ 1 more variable: glycan_structure &lt;struct&gt;</span></span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://glycoverse.github.io/glyexp/reference/get_sample_info.html" class="external-link">get_sample_info</a></span><span class="op">(</span><span class="va">exp</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 12 √ó 3</span></span></span>
<span><span class="co">#&gt;    sample group batch</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> C1     C     A    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> C2     C     B    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> C3     C     C    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> H1     H     A    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> H2     H     B    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> H3     H     C    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> M1     M     A    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> M2     M     B    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> M3     M     C    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Y1     Y     A    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> Y2     Y     B    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> Y3     Y     C</span></span></code></pre></div>
<p>What we have here is a beautiful N-glycoproteomics dataset featuring
500 PSMs (Peptide Spectrum Matches) across 12 samples. These samples
come from 3 different batches and represent 4 distinct biological groups
‚Äì a perfect playground for demonstrating preprocessing techniques!</p>
</div>
<div class="section level2">
<h2 id="the-magic-wand-one-function-to-rule-them-all">The Magic Wand: One Function to Rule Them All ‚ú®<a class="anchor" aria-label="anchor" href="#the-magic-wand-one-function-to-rule-them-all"></a>
</h2>
<p>Ready for some magic? Watch this:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clean_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/auto_clean.html">auto_clean</a></span><span class="op">(</span><span class="va">exp</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ‚îÄ‚îÄ <span style="font-weight: bold;">Normalizing data</span> ‚îÄ‚îÄ</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">‚Ñπ</span> No QC samples found. Using default normalization method based on experiment type.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">‚Ñπ</span> Experiment type is <span style="color: #0000BB;">"glycoproteomics"</span>. Using `normalize_median()`.</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">‚úî</span> Normalization completed.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ‚îÄ‚îÄ <span style="font-weight: bold;">Removing variables with too many missing values</span> ‚îÄ‚îÄ</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">‚Ñπ</span> No QC samples found. Using all samples.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">‚Ñπ</span> Applying preset <span style="color: #0000BB;">"discovery"</span>...</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">‚Ñπ</span> Total removed: <span style="color: #0000BB;">24</span> (<span style="color: #0000BB;">0.56</span>%) variables.</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">‚úî</span> Variable removal completed.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ‚îÄ‚îÄ <span style="font-weight: bold;">Imputing missing values</span> ‚îÄ‚îÄ</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">‚Ñπ</span> No QC samples found. Using default imputation method based on sample size.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">‚Ñπ</span> Sample size &lt;= 30, using `impute_sample_min()`.</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">‚úî</span> Imputation completed.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ‚îÄ‚îÄ <span style="font-weight: bold;">Aggregating data</span> ‚îÄ‚îÄ</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">‚Ñπ</span> Aggregating to <span style="color: #0000BB;">"gfs"</span> level</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">‚úî</span> Aggregation completed.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ‚îÄ‚îÄ <span style="font-weight: bold;">Normalizing data again</span> ‚îÄ‚îÄ</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">‚Ñπ</span> No QC samples found. Using default normalization method based on experiment type.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">‚Ñπ</span> Experiment type is <span style="color: #0000BB;">"glycoproteomics"</span>. Using `normalize_median()`.</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">‚úî</span> Normalization completed.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ‚îÄ‚îÄ <span style="font-weight: bold;">Correcting batch effects</span> ‚îÄ‚îÄ</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">‚Ñπ</span> Batch column  not found in sample_info. Skipping batch correction.</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">‚úî</span> Batch correction completed.</span></span></code></pre></div>
<p><strong>That‚Äôs it!</strong> Your data is now preprocessed and ready
for analysis! üéâ</p>
<p>But Wait, What Just Happened? <code><a href="../reference/auto_clean.html">auto_clean()</a></code> isn‚Äôt
actually magic (sorry to disappoint) ‚Äì it‚Äôs a carefully designed
intelligent pipeline that:</p>
<ul>
<li>
<strong>Analyzes your data</strong>: Checks experiment type, sample
size, and metadata</li>
<li>
<strong>Selects optimal methods</strong>: Chooses the best
preprocessing strategy for your specific dataset</li>
<li>
<strong>Executes the pipeline</strong>: Runs everything in the
optimal order</li>
</ul>
</div>
<div class="section level2">
<h2 id="still-like-magic-but-with-more-control">Still Like Magic, but With More Control?<a class="anchor" aria-label="anchor" href="#still-like-magic-but-with-more-control"></a>
</h2>
<p>Let‚Äôs look into the details of what <code><a href="../reference/auto_clean.html">auto_clean()</a></code> does.
Here is a simplified version of the function:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">auto_clean</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">exp</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># ... are other arguments, see documentation for more details</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu">glyexp</span><span class="fu">::</span><span class="fu"><a href="https://glycoverse.github.io/glyexp/reference/get_meta_data.html" class="external-link">get_exp_type</a></span><span class="op">(</span><span class="va">exp</span><span class="op">)</span> <span class="op">==</span> <span class="st">"glycoproteomics"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/auto_normalize.html">auto_normalize</a></span><span class="op">(</span><span class="va">exp</span>, <span class="va">...</span><span class="op">)</span></span>
<span>    <span class="va">exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/auto_remove.html">auto_remove</a></span><span class="op">(</span><span class="va">exp</span>, <span class="va">...</span><span class="op">)</span></span>
<span>    <span class="va">exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/auto_impute.html">auto_impute</a></span><span class="op">(</span><span class="va">exp</span>, <span class="va">...</span><span class="op">)</span></span>
<span>    <span class="va">exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/auto_aggregate.html">auto_aggregate</a></span><span class="op">(</span><span class="va">exp</span><span class="op">)</span></span>
<span>    <span class="va">exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/auto_normalize.html">auto_normalize</a></span><span class="op">(</span><span class="va">exp</span>, <span class="va">...</span><span class="op">)</span></span>
<span>    <span class="va">exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/auto_correct_batch_effect.html">auto_correct_batch_effect</a></span><span class="op">(</span><span class="va">exp</span>, <span class="va">...</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="fu">glyexp</span><span class="fu">::</span><span class="fu"><a href="https://glycoverse.github.io/glyexp/reference/get_meta_data.html" class="external-link">get_exp_type</a></span><span class="op">(</span><span class="va">exp</span><span class="op">)</span> <span class="op">==</span> <span class="st">"glycomics"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/auto_remove.html">auto_remove</a></span><span class="op">(</span><span class="va">exp</span>, <span class="va">...</span><span class="op">)</span></span>
<span>    <span class="va">exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/auto_normalize.html">auto_normalize</a></span><span class="op">(</span><span class="va">exp</span>, <span class="va">...</span><span class="op">)</span></span>
<span>    <span class="va">exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/normalize_total_area.html">normalize_total_area</a></span><span class="op">(</span><span class="va">exp</span><span class="op">)</span></span>
<span>    <span class="va">exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/auto_impute.html">auto_impute</a></span><span class="op">(</span><span class="va">exp</span>, <span class="va">...</span><span class="op">)</span></span>
<span>    <span class="va">exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/auto_correct_batch_effect.html">auto_correct_batch_effect</a></span><span class="op">(</span><span class="va">exp</span>, <span class="va">...</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"The experiment type must be 'glycoproteomics' or 'glycomics'."</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">exp</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>As you can see, <code><a href="../reference/auto_clean.html">auto_clean()</a></code> calls the following
functions in sequence:</p>
<ul>
<li>
<code><a href="../reference/auto_normalize.html">auto_normalize()</a></code>: Automatically normalize the data</li>
<li>
<code><a href="../reference/auto_remove.html">auto_remove()</a></code>: Automatically remove variables with too
many missing values</li>
<li>
<code><a href="../reference/auto_impute.html">auto_impute()</a></code>: Automatically impute the missing
values</li>
<li>
<code><a href="../reference/auto_aggregate.html">auto_aggregate()</a></code>: Automatically aggregate the data</li>
<li>
<code><a href="../reference/auto_correct_batch_effect.html">auto_correct_batch_effect()</a></code>: Automatically correct the
batch effects</li>
</ul>
<p>These functions automatically choose the best method for the given
dataset. For example, if a ‚Äúgroup‚Äù column exists and there are QC
samples, <code><a href="../reference/auto_normalize.html">auto_normalize()</a></code> will try all normalization
methods and choose the one that best stabilizes the QC samples.</p>
<p>You can make a custom pipeline by calling these functions in
different orders:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clean_exp</span> <span class="op">&lt;-</span> <span class="va">exp</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/auto_remove.html">auto_remove</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/auto_normalize.html">auto_normalize</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/auto_impute.html">auto_impute</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/auto_aggregate.html">auto_aggregate</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">‚Ñπ</span> No QC samples found. Using all samples.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">‚Ñπ</span> Applying preset <span style="color: #0000BB;">"discovery"</span>...</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">‚Ñπ</span> Total removed: <span style="color: #0000BB;">24</span> (<span style="color: #0000BB;">0.56</span>%) variables.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">‚Ñπ</span> No QC samples found. Using default normalization method based on experiment type.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">‚Ñπ</span> Experiment type is <span style="color: #0000BB;">"glycoproteomics"</span>. Using `normalize_median()`.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">‚Ñπ</span> No QC samples found. Using default imputation method based on sample size.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">‚Ñπ</span> Sample size &lt;= 30, using `impute_sample_min()`.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">‚Ñπ</span> Aggregating to <span style="color: #0000BB;">"gfs"</span> level</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="taking-the-scenic-route-step-by-step-preprocessing">Taking the Scenic Route: Step-by-Step Preprocessing üö∂‚Äç‚ôÄÔ∏è<a class="anchor" aria-label="anchor" href="#taking-the-scenic-route-step-by-step-preprocessing"></a>
</h2>
<p>While <code><a href="../reference/auto_clean.html">auto_clean()</a></code> and other <code>auto_xxx()</code>
functions are fantastic for getting started, you‚Äôll eventually want more
control over your preprocessing pipeline. Let‚Äôs explore each step
individually ‚Äì think of it as learning to cook rather than just ordering
takeout!</p>
<div class="section level3">
<h3 id="step-1-normalization-getting-everyone-on-the-same-page">Step 1: Normalization ‚Äì Getting Everyone on the Same Page üìè<a class="anchor" aria-label="anchor" href="#step-1-normalization-getting-everyone-on-the-same-page"></a>
</h3>
<p>Imagine you‚Äôre comparing heights of people measured in different
units ‚Äì some in feet, some in meters, some in furlongs (okay, maybe not
furlongs). Normalization does the same thing for your omics data,
bringing all intensities to a comparable scale.</p>
<p><strong>Available normalization methods in
<code>glyclean</code>:</strong></p>
<table class="table">
<colgroup>
<col width="30%">
<col width="39%">
<col width="30%">
</colgroup>
<thead><tr class="header">
<th>Function</th>
<th>Description</th>
<th>Best For</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code><a href="../reference/normalize_median.html">normalize_median()</a></code></td>
<td>Median-based normalization</td>
<td>General use, robust to outliers</td>
</tr>
<tr class="even">
<td><code><a href="../reference/normalize_median_abs.html">normalize_median_abs()</a></code></td>
<td>Median absolute deviation</td>
<td>When you need extra robustness</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/normalize_median_quotient.html">normalize_median_quotient()</a></code></td>
<td>Median quotient method</td>
<td>Compositional data</td>
</tr>
<tr class="even">
<td><code><a href="../reference/normalize_quantile.html">normalize_quantile()</a></code></td>
<td>Quantile normalization</td>
<td>When you want identical distributions</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/normalize_total_area.html">normalize_total_area()</a></code></td>
<td>Total area normalization</td>
<td>Relative abundance data</td>
</tr>
<tr class="even">
<td><code><a href="../reference/normalize_rlr.html">normalize_rlr()</a></code></td>
<td>Robust linear regression</td>
<td>Complex batch designs</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/normalize_rlrma.html">normalize_rlrma()</a></code></td>
<td>Robust linear regression with median adjustment</td>
<td>Complex batch designs</td>
</tr>
<tr class="even">
<td><code><a href="../reference/normalize_rlrmacyc.html">normalize_rlrmacyc()</a></code></td>
<td>Robust linear regression with median adjustment and cyclic
smoothing</td>
<td>Complex batch designs</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/normalize_loessf.html">normalize_loessf()</a></code></td>
<td>LOESS with feature smoothing</td>
<td>Non-linear trends</td>
</tr>
<tr class="even">
<td><code><a href="../reference/normalize_loesscyc.html">normalize_loesscyc()</a></code></td>
<td>LOESS with cyclic smoothing</td>
<td>Cyclic data</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/normalize_vsn.html">normalize_vsn()</a></code></td>
<td>Variance stabilizing normalization</td>
<td>Heteroscedastic data</td>
</tr>
</tbody>
</table>
<p><strong>Pro Tips:</strong></p>
<ul>
<li>Notice the <code>by</code> parameter in many functions? This allows
stratified normalization within groups ‚Äì super useful when you have
distinct experimental conditions!</li>
<li>
<strong>Maximum flexibility</strong>: The <code>by</code> parameter
accepts both column names from your sample metadata and direct vectors!
This gives you complete control over grouping, even for custom groupings
that aren‚Äôt stored in your experiment object.</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example: Using by parameter with a custom vector</span></span>
<span><span class="co"># Normalize within custom groups (e.g., based on some external criteria)</span></span>
<span><span class="va">custom_groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"C"</span>, <span class="st">"A"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"C"</span><span class="op">)</span></span>
<span><span class="va">normalized_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/normalize_median.html">normalize_median</a></span><span class="op">(</span><span class="va">exp</span>, by <span class="op">=</span> <span class="va">custom_groups</span><span class="op">)</span></span></code></pre></div>
<p>Here we do the median normalization manually:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">normed_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/normalize_median.html">normalize_median</a></span><span class="op">(</span><span class="va">exp</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-2-variable-filtering-saying-goodbye-to-the-unreliable">Step 2: Variable Filtering ‚Äì Saying Goodbye to the Unreliable
üßπ<a class="anchor" aria-label="anchor" href="#step-2-variable-filtering-saying-goodbye-to-the-unreliable"></a>
</h3>
<p>Some variables are like that friend who never shows up to plans ‚Äì
they‚Äôre missing most of the time and aren‚Äôt very helpful. In omics data,
variables with too many missing values are often more noise than
signal.</p>
<p><strong>Available variable filtering functions in
<code>glyclean</code>:</strong></p>
<table class="table">
<colgroup>
<col width="30%">
<col width="39%">
<col width="30%">
</colgroup>
<thead><tr class="header">
<th>Function</th>
<th>Description</th>
<th>Best For</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code><a href="../reference/remove_rare.html">remove_rare()</a></code></td>
<td>Remove variables with too many missing values</td>
<td>General use</td>
</tr>
<tr class="even">
<td><code><a href="../reference/remove_low_var.html">remove_low_var()</a></code></td>
<td>Remove variables with low variance</td>
<td>General use</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/remove_low_cv.html">remove_low_cv()</a></code></td>
<td>Remove variables with low coefficient of variation</td>
<td>General use</td>
</tr>
<tr class="even">
<td><code><a href="../reference/remove_constant.html">remove_constant()</a></code></td>
<td>Remove constant variables</td>
<td>General use</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/remove_low_expr.html">remove_low_expr()</a></code></td>
<td>Remove variables with low expression</td>
<td>General use</td>
</tr>
</tbody>
</table>
<p>Here we remove variables with more than 50% missing values in all
samples:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">filtered_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/remove_rare.html">remove_rare</a></span><span class="op">(</span><span class="va">normed_exp</span>, prop <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">‚Ñπ</span> Removed <span style="color: #0000BB;">137</span> of <span style="color: #0000BB;">4262</span> (<span style="color: #0000BB;">3.21</span>%) variables.</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-3-imputation-filling-in-the-blanks-intelligently">Step 3: Imputation ‚Äì Filling in the Blanks Intelligently üîÆ<a class="anchor" aria-label="anchor" href="#step-3-imputation-filling-in-the-blanks-intelligently"></a>
</h3>
<p>Here‚Äôs where things get scientifically interesting! Missing values in
mass spectrometry aren‚Äôt randomly distributed ‚Äì they follow patterns
based on the physics and chemistry of the measurement process.</p>
<p><strong>The Science:</strong> Missing values in MS-based omics data
are typically ‚ÄúMissing Not At Random‚Äù (MNAR), meaning they‚Äôre related to
the intensity of the signal. Low-abundance ions are more likely to be
missed, either due to poor ionization efficiency or because they fall
below the detection threshold.</p>
<p><strong>Your imputation toolkit:</strong></p>
<table class="table">
<colgroup>
<col width="35%">
<col width="28%">
<col width="35%">
</colgroup>
<thead><tr class="header">
<th>Function</th>
<th>Method</th>
<th>Best For</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code><a href="../reference/impute_zero.html">impute_zero()</a></code></td>
<td>Replace with zeros</td>
<td>Quick and simple</td>
</tr>
<tr class="even">
<td><code><a href="../reference/impute_sample_min.html">impute_sample_min()</a></code></td>
<td>Sample minimum values</td>
<td>Small datasets</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/impute_half_sample_min.html">impute_half_sample_min()</a></code></td>
<td>Half of sample minimum</td>
<td>Conservative approach</td>
</tr>
<tr class="even">
<td><code><a href="../reference/impute_min_prob.html">impute_min_prob()</a></code></td>
<td>Probabilistic minimum</td>
<td>Medium datasets</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/impute_miss_forest.html">impute_miss_forest()</a></code></td>
<td>Random Forest ML</td>
<td>Large datasets</td>
</tr>
<tr class="even">
<td><code><a href="../reference/impute_bpca.html">impute_bpca()</a></code></td>
<td>Bayesian PCA</td>
<td>High correlation structure</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/impute_ppca.html">impute_ppca()</a></code></td>
<td>Probabilistic PCA</td>
<td>Linear relationships</td>
</tr>
<tr class="even">
<td><code><a href="../reference/impute_sw_knn.html">impute_sw_knn()</a></code></td>
<td>K-nearest neighbors (Sample-wise)</td>
<td>Local similarity patterns</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/impute_fw_knn.html">impute_fw_knn()</a></code></td>
<td>K-nearest neighbors (Feature-wise)</td>
<td>Local similarity patterns</td>
</tr>
<tr class="even">
<td><code><a href="../reference/impute_svd.html">impute_svd()</a></code></td>
<td>Singular value decomposition</td>
<td>High correlation structure</td>
</tr>
</tbody>
</table>
<p>For demonstration, let‚Äôs use the simple zero imputation:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">imputed_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/impute_zero.html">impute_zero</a></span><span class="op">(</span><span class="va">filtered_exp</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-4-aggregation-from-peptides-to-glycoforms">Step 4: Aggregation ‚Äì From Peptides to Glycoforms üîÑ<a class="anchor" aria-label="anchor" href="#step-4-aggregation-from-peptides-to-glycoforms"></a>
</h3>
<p>Here‚Äôs where glycoproteomics gets uniquely challenging! Search
engines typically report results at the PSM or peptide level, but what
we really care about are <strong>glycoforms</strong> ‚Äì the specific
glycan structures attached to specific protein sites.</p>
<p><strong>The Problem:</strong> One glycoform can appear multiple times
in your data due to:</p>
<ul>
<li>Different charge states</li>
<li>Post-translational modifications</li>
<li>Missed protease cleavages</li>
<li>Different peptide sequences covering the same site</li>
</ul>
<p><strong>The Solution:</strong> Intelligent aggregation!</p>
<p><strong>Aggregation levels available:</strong></p>
<ul>
<li>
<strong>‚Äúgps‚Äù</strong>: Glycopeptides with structures (most
detailed)</li>
<li>
<strong>‚Äúgp‚Äù</strong>: Glycopeptides with compositions</li>
<li>
<strong>‚Äúgfs‚Äù</strong>: Glycoforms with structures (recommended
default)</li>
<li>
<strong>‚Äúgf‚Äù</strong>: Glycoforms with compositions (most
condensed)</li>
</ul>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aggregated_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aggregate.html">aggregate</a></span><span class="op">(</span><span class="va">imputed_exp</span>, to_level <span class="op">=</span> <span class="st">"gf"</span><span class="op">)</span></span></code></pre></div>
<p><strong>Pro move:</strong> Re-normalize after aggregation to account
for the new intensity distributions:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aggregated_exp2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/normalize_median.html">normalize_median</a></span><span class="op">(</span><span class="va">aggregated_exp</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-5-batch-effect-correction-harmonizing-your-orchestra">Step 5: Batch Effect Correction ‚Äì Harmonizing Your Orchestra üéº<a class="anchor" aria-label="anchor" href="#step-5-batch-effect-correction-harmonizing-your-orchestra"></a>
</h3>
<p>Batch effects are the ‚Äúdifferent violinists playing the same piece‚Äù
problem of omics data. Even when following identical protocols, subtle
differences in instruments, reagents, or environmental conditions can
introduce systematic bias.</p>
<p><strong>The Good News:</strong> If your experimental design is
well-controlled (conditions distributed across batches), batch effect
correction can work wonders!</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># To detect batch effects:</span></span>
<span><span class="va">p_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/detect_batch_effect.html">detect_batch_effect</a></span><span class="op">(</span><span class="va">aggregated_exp2</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">‚Ñπ</span> Detecting batch effects using ANOVA for 2738 variables...</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">‚úî</span> Batch effect detection completed. 19 out of 2738 variables show significant batch effects (p &lt; 0.05).</span></span>
<span><span class="va">p_values</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="co">#&gt; P08185-N176-Hex(5)HexNAc(4)NeuAc(2) P04196-N344-Hex(5)HexNAc(4)NeuAc(1) </span></span>
<span><span class="co">#&gt;                           0.6998998                           0.3951691 </span></span>
<span><span class="co">#&gt;         P04196-N344-Hex(5)HexNAc(4)         P10909-N291-Hex(6)HexNAc(5) </span></span>
<span><span class="co">#&gt;                           0.4852698                           0.3329619 </span></span>
<span><span class="co">#&gt; P04196-N344-Hex(5)HexNAc(4)NeuAc(2) </span></span>
<span><span class="co">#&gt;                           0.4907154</span></span></code></pre></div>
<p>Here we do not have batch effects, but we will correct it anyway for
demonstration.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># To correct batch effects:</span></span>
<span><span class="va">corrected_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/correct_batch_effect.html">correct_batch_effect</a></span><span class="op">(</span><span class="va">aggregated_exp2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Found3batches</span></span>
<span><span class="co">#&gt; Adjusting for0covariate(s) or covariate level(s)</span></span>
<span><span class="co">#&gt; Standardizing Data across genes</span></span>
<span><span class="co">#&gt; Fitting L/S model and finding priors</span></span>
<span><span class="co">#&gt; Finding parametric adjustments</span></span>
<span><span class="co">#&gt; Adjusting the Data</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-6-protein-expression-adjustment-separating-signal-from-noise">Step 6: Protein Expression Adjustment ‚Äì Separating Signal from Noise
üéØ<a class="anchor" aria-label="anchor" href="#step-6-protein-expression-adjustment-separating-signal-from-noise"></a>
</h3>
<p>Here‚Äôs a fascinating biological puzzle: when you measure a
glycopeptide‚Äôs intensity, you‚Äôre actually seeing two stories at
once!</p>
<p><strong>The Dual Nature Problem:</strong> Every glycopeptide
intensity is a tale of two factors:</p>
<ul>
<li>
<strong>The protein story</strong>: How much of the substrate
protein is present</li>
<li>
<strong>The glycosylation story</strong>: How actively that protein
is being glycosylated</li>
</ul>
<p>It‚Äôs like trying to understand applause volume ‚Äì is the audience
bigger, or are they just more enthusiastic?</p>
<p><strong>The Solution:</strong> If you‚Äôre specifically interested in
glycosylation changes (not protein abundance changes), you need to
mathematically ‚Äúsubtract out‚Äù the protein expression component. Think of
it as noise cancellation for biology!</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># We don't run the code here because we don't have the protein expression matrix.</span></span>
<span><span class="va">adjusted_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/adjust_protein.html">adjust_protein</a></span><span class="op">(</span><span class="va">inferred_exp</span>, <span class="va">pro_expr_mat</span><span class="op">)</span></span></code></pre></div>
<p><strong>Important Prerequisites:</strong></p>
<ul>
<li>Your protein expression matrix must have the same samples as your
glycopeptide data</li>
<li>The protein expression matrix should be properly preprocessed (good
news: you can use <code>glyclean</code> functions for this too!)</li>
<li>Sample matching needs to be perfect ‚Äì no mixing apples with
oranges!</li>
</ul>
<p><strong>Pro Tip:</strong> Most <code>glyclean</code> functions
happily accept plain matrices as input, so you can preprocess your
protein expression data using the same toolkit. Consistency is key!</p>
</div>
<div class="section level3">
<h3 id="mission-accomplished">üéâ Mission Accomplished!<a class="anchor" aria-label="anchor" href="#mission-accomplished"></a>
</h3>
<p>Congratulations! You now have beautifully preprocessed,
analysis-ready glycoproteomics data. Your data has been normalized,
filtered, imputed, aggregated, and batch-corrected ‚Äì it‚Äôs ready to
reveal its biological secrets!</p>
</div>
</div>
<div class="section level2">
<h2 id="advanced-usage-beyond-glyexpexperiment-objects">Advanced Usage: Beyond <code>glyexp::experiment()</code> Objects
üîß<a class="anchor" aria-label="anchor" href="#advanced-usage-beyond-glyexpexperiment-objects"></a>
</h2>
<p>While this vignette focuses on <code><a href="https://glycoverse.github.io/glyexp/reference/experiment.html" class="external-link">glyexp::experiment()</a></code>
objects, <code>glyclean</code> is designed to be flexible and
accommodating to different workflows and data formats.</p>
<div class="section level3">
<h3 id="working-with-plain-matrices">Working with Plain Matrices<a class="anchor" aria-label="anchor" href="#working-with-plain-matrices"></a>
</h3>
<p>Most <code>glyclean</code> functions also support plain matrices as
input! This means you can use the package‚Äôs powerful preprocessing
capabilities even if you‚Äôre working with traditional data formats. The
functions intelligently detect your input type and handle it
appropriately.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example: Using glyclean with a plain matrix</span></span>
<span><span class="va">my_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">normalized_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/normalize_median.html">normalize_median</a></span><span class="op">(</span><span class="va">my_matrix</span><span class="op">)</span></span>
<span><span class="va">imputed_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/impute_sample_min.html">impute_sample_min</a></span><span class="op">(</span><span class="va">normalized_matrix</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="flexible-grouping-with-custom-vectors">Flexible Grouping with Custom Vectors<a class="anchor" aria-label="anchor" href="#flexible-grouping-with-custom-vectors"></a>
</h3>
<p>Many functions in <code>glyclean</code> accept a <code>by</code>
parameter for stratified processing. This parameter offers maximum
flexibility ‚Äì it accepts both column names from your sample metadata and
direct vectors!</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Using column names (standard approach)</span></span>
<span><span class="va">normalized_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/normalize_median.html">normalize_median</a></span><span class="op">(</span><span class="va">exp</span>, by <span class="op">=</span> <span class="st">"group"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Using custom vectors (advanced approach)</span></span>
<span><span class="va">custom_groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"C"</span>, <span class="st">"A"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"C"</span><span class="op">)</span></span>
<span><span class="va">normalized_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/normalize_median.html">normalize_median</a></span><span class="op">(</span><span class="va">exp</span>, by <span class="op">=</span> <span class="va">custom_groups</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># This also works with matrices</span></span>
<span><span class="va">normalized_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/normalize_median.html">normalize_median</a></span><span class="op">(</span><span class="va">my_matrix</span>, by <span class="op">=</span> <span class="va">custom_groups</span><span class="op">)</span></span></code></pre></div>
<p>This gives you complete control over grouping, even for custom
groupings that aren‚Äôt stored in your experiment object. Perfect for
complex experimental designs or external grouping criteria!</p>
</div>
</div>
<div class="section level2">
<h2 id="quality-control-qc">Quality Control (QC) üìä<a class="anchor" aria-label="anchor" href="#quality-control-qc"></a>
</h2>
<p><code>glyclean</code> provides a comprehensive suite of quality
control plotting functions to help you visualize and assess the quality
of your data at various stages of the preprocessing pipeline.</p>
<p><strong>Available QC plotting functions in
<code>glyclean</code>:</strong></p>
<table class="table">
<colgroup>
<col width="30%">
<col width="39%">
<col width="30%">
</colgroup>
<thead><tr class="header">
<th>Function</th>
<th>Description</th>
<th>Best For</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code><a href="../reference/plot_missing_heatmap.html">plot_missing_heatmap()</a></code></td>
<td>Binary heatmap of missing value patterns</td>
<td>Visualizing global missingness structure</td>
</tr>
<tr class="even">
<td><code><a href="../reference/plot_missing_bar.html">plot_missing_bar()</a></code></td>
<td>Bar plot of missing proportions</td>
<td>Identifying samples/variables with high missingness</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/plot_tic_bar.html">plot_tic_bar()</a></code></td>
<td>Total intensity (TIC) bar plot</td>
<td>Checking for systematic intensity differences between samples</td>
</tr>
<tr class="even">
<td><code><a href="../reference/plot_rank_abundance.html">plot_rank_abundance()</a></code></td>
<td>Protein rank abundance plot</td>
<td>Assessing the dynamic range of detected proteins</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/plot_int_boxplot.html">plot_int_boxplot()</a></code></td>
<td>Log2-intensity boxplots</td>
<td>Visualizing data distribution and normalization effects</td>
</tr>
<tr class="even">
<td><code><a href="../reference/plot_rle.html">plot_rle()</a></code></td>
<td>Relative Log Expression (RLE) boxplots</td>
<td>Detecting sample-wise bias and batch effects</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/plot_cv_dent.html">plot_cv_dent()</a></code></td>
<td>CV density plot</td>
<td>Assessing reproducibility and technical variation</td>
</tr>
<tr class="even">
<td><code><a href="../reference/plot_batch_pca.html">plot_batch_pca()</a></code></td>
<td>PCA score plot by batch</td>
<td>Visualizing batch effects and sample clustering</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/plot_rep_scatter.html">plot_rep_scatter()</a></code></td>
<td>Replicate scatter plots</td>
<td>Checking concordance between replicate samples</td>
</tr>
</tbody>
</table>
<p>These functions are designed to work seamlessly with
<code><a href="https://glycoverse.github.io/glyexp/reference/experiment.html" class="external-link">glyexp::experiment()</a></code> objects and provide consistent,
high-quality visualizations using <code>ggplot2</code>.</p>
<p>For example, you can use <code><a href="../reference/plot_missing_heatmap.html">plot_missing_heatmap()</a></code> to
visualize the missing values in your data before and after cleaning:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_missing_heatmap.html">plot_missing_heatmap</a></span><span class="op">(</span><span class="va">exp</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/plot_missing_heatmap.html">plot_missing_heatmap</a></span><span class="op">(</span><span class="va">clean_exp</span><span class="op">)</span></span></code></pre></div>
<p><img src="glyclean_files/figure-html/unnamed-chunk-17-1.png" class="r-plt" alt="" width="576"></p>
</div>
<div class="section level2">
<h2 id="whats-next">What‚Äôs Next?<a class="anchor" aria-label="anchor" href="#whats-next"></a>
</h2>
<p>With your clean data in hand, you‚Äôre ready to dive into the exciting
world of glyco-omics analysis:</p>
<ul>
<li>
<strong>Differential analysis</strong>: Find glycans that change
between conditions</li>
<li>
<strong>Pathway analysis</strong>: Understand biological
processes</li>
<li>
<strong>Machine learning</strong>: Build predictive models</li>
<li>
<strong>Visualization</strong>: Create stunning plots that tell your
data‚Äôs story</li>
</ul>
<p>The <code>glycoverse</code> ecosystem has tools for all of these and
more!</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bin Fu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
