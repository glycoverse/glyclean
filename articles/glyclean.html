<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Get Started with glyclean • glyclean</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Get Started with glyclean">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">glyclean</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/glyclean.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Get Started with glyclean</h1>
            
      

      <div class="d-none name"><code>glyclean.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="welcome-to-the-wild-world-of-data-preprocessing">Welcome to the Wild World of Data Preprocessing! 🧬<a class="anchor" aria-label="anchor" href="#welcome-to-the-wild-world-of-data-preprocessing"></a>
</h2>
<p>Every omics data analysis journey begins with the same challenge:
taming your raw data. Think of it like preparing ingredients before
cooking a gourmet meal – you need to wash, chop, and season everything
just right. In the glycomics and glycoproteomics world, this means
normalization, missing value handling, and batch effect correction.</p>
<p>Meet <code>glyclean</code> – your Swiss Army knife for
glycoproteomics and glycomics data preprocessing! This package provides
a comprehensive toolkit that takes the guesswork out of data cleaning,
with specialized methods designed specifically for the unique challenges
of glycan analysis.</p>
<p><strong>Important Note:</strong> This package works with
<code><a href="https://glycoverse.github.io/glyexp/reference/experiment.html" class="external-link">glyexp::experiment()</a></code> objects. If you’re new to this data
structure, we highly recommend checking out <a href="https://glycoverse.github.io/glyexp/articles/glyexp.html" class="external-link">its
introduction</a> first. We’ll also be using the <a href="https://github.com/glycoverse/glyread" class="external-link">glyread</a> package to load
our data – it’s the go-to tool in the <code>glycoverse</code>
ecosystem.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://glycoverse.github.io/glyclean/">glyclean</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'glyclean'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     aggregate</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://glycoverse.github.io/glyread/" class="external-link">glyread</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://glycoverse.github.io/glyexp/" class="external-link">glyexp</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="meet-our-star-player-real-glycoproteomics-data">Meet Our Star Player: Real Glycoproteomics Data 🌟<a class="anchor" aria-label="anchor" href="#meet-our-star-player-real-glycoproteomics-data"></a>
</h2>
<p>Let’s dive in with a real-world dataset that will showcase what
<code>glyclean</code> can do. We’ll use
<code><a href="https://glycoverse.github.io/glyread/reference/read_pglyco3_pglycoquant.html" class="external-link">glyread::read_pglyco3_pglycoquant()</a></code> to load our data into a
proper <code><a href="https://glycoverse.github.io/glyexp/reference/experiment.html" class="external-link">glyexp::experiment()</a></code> object.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://glycoverse.github.io/glyread/reference/read_pglyco3_pglycoquant.html" class="external-link">read_pglyco3_pglycoquant</a></span><span class="op">(</span></span>
<span>  <span class="st">"glycopeptides.list"</span>,</span>
<span>  sample_info <span class="op">=</span> <span class="st">"sample_info.csv"</span>,</span>
<span>  glycan_type <span class="op">=</span> <span class="st">"N"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Reading data</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Reading data <span style="color: #B2B2B2;">[340ms]</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Parsing glycan compositions</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Parsing glycan compositions <span style="color: #B2B2B2;">[213ms]</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Parsing glycan structures</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Parsing glycan structures <span style="color: #B2B2B2;">[2.9s]</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Packing experiment</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Packing experiment <span style="color: #B2B2B2;">[23ms]</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="va">exp</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Experiment</span> <span style="color: #00BBBB;">──────────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Expression matrix: <span style="color: #0000BB;">12</span> samples, <span style="color: #0000BB;">500</span> variables</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Sample information fields: <span style="color: #00BB00;">group</span> and <span style="color: #00BB00;">batch</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Variable information fields: <span style="color: #00BB00;">peptide</span>, <span style="color: #00BB00;">proteins</span>, <span style="color: #00BB00;">genes</span>, <span style="color: #00BB00;">glycan_composition</span>, <span style="color: #00BB00;">glycan_structure</span>, <span style="color: #00BB00;">peptide_site</span>, <span style="color: #00BB00;">protein_sites</span>, <span style="color: #00BB00;">charge</span>, and <span style="color: #00BB00;">modifications</span></span></span></code></pre></div>
<p>Let’s peek under the hood and see what we’re working with:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://glycoverse.github.io/glyexp/reference/get_var_info.html" class="external-link">get_var_info</a></span><span class="op">(</span><span class="va">exp</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 500 × 10</span></span></span>
<span><span class="co">#&gt;    variable peptide        proteins    genes glycan_composition glycan_structure</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;comp&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;structure&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> PSM1     JKTQGK         sp|P08185|… SERP… Hex(5)HexNAc(4)Ne… NeuAc(??-?)Hex(…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> PSM2     HSHNJJSSDLHPHK sp|P04196|… HRG   Hex(5)HexNAc(4)Ne… NeuAc(??-?)Hex(…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> PSM3     HSHNJJSSDLHPHK sp|P04196|… HRG   Hex(5)HexNAc(4)    Hex(??-?)HexNAc…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> PSM4     HSHNJJSSDLHPHK sp|P04196|… HRG   Hex(5)HexNAc(4)Ne… NeuAc(??-?)Hex(…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> PSM5     HJSTGCLR       sp|P10909|… CLU   Hex(6)HexNAc(5)    Hex(??-?)HexNAc…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> PSM6     HSHNJJSSDLHPHK sp|P04196|… HRG   Hex(5)HexNAc(4)Ne… NeuAc(??-?)Hex(…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> PSM7     HSHNJJSSDLHPHK sp|P04196|… HRG   Hex(5)HexNAc(4)Ne… NeuAc(??-?)Hex(…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> PSM8     HSHNJJSSDLHPHK sp|P04196|… HRG   Hex(5)HexNAc(4)Ne… NeuAc(??-?)Hex(…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> PSM9     HSHNJJSSDLHPHK sp|P04196|… HRG   Hex(5)HexNAc(4)Ne… NeuAc(??-?)Hex(…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> PSM10    HSHNJJSSDLHPHK sp|P04196|… HRG   Hex(5)HexNAc(4)    Hex(??-?)HexNAc…</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 490 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 4 more variables: peptide_site &lt;int&gt;, protein_sites &lt;chr&gt;, charge &lt;int&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   modifications &lt;chr&gt;</span></span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://glycoverse.github.io/glyexp/reference/get_sample_info.html" class="external-link">get_sample_info</a></span><span class="op">(</span><span class="va">exp</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 12 × 3</span></span></span>
<span><span class="co">#&gt;    sample                  group batch</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 20241224-LXJ-Nglyco-C_1 C         1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 20241224-LXJ-Nglyco-C_2 C         2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 20241224-LXJ-Nglyco-C_3 C         3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 20241224-LXJ-Nglyco-H_1 H         1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 20241224-LXJ-Nglyco-H_2 H         2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 20241224-LXJ-Nglyco-H_3 H         3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 20241224-LXJ-Nglyco-M_1 M         1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 20241224-LXJ-Nglyco-M_2 M         2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 20241224-LXJ-Nglyco-M_3 M         3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 20241224-LXJ-Nglyco-Y_1 Y         1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> 20241224-LXJ-Nglyco-Y_2 Y         2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> 20241224-LXJ-Nglyco-Y_3 Y         3</span></span></code></pre></div>
<p>What we have here is a beautiful N-glycoproteomics dataset featuring
500 PSMs (Peptide Spectrum Matches) across 12 samples. These samples
come from 3 different batches and represent 4 distinct biological groups
– a perfect playground for demonstrating preprocessing techniques!</p>
</div>
<div class="section level2">
<h2 id="the-magic-wand-one-function-to-rule-them-all">The Magic Wand: One Function to Rule Them All ✨<a class="anchor" aria-label="anchor" href="#the-magic-wand-one-function-to-rule-them-all"></a>
</h2>
<div class="section level3">
<h3 id="meet-auto_clean-your-preprocessing-superhero">Meet <code>auto_clean()</code> – Your Preprocessing Superhero<a class="anchor" aria-label="anchor" href="#meet-auto_clean-your-preprocessing-superhero"></a>
</h3>
<p>Ready for some magic? Watch this:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clean_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/auto_clean.html">auto_clean</a></span><span class="op">(</span><span class="va">exp</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Normalizing data (Median)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Normalizing data (Median) <span style="color: #B2B2B2;">[209ms]</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Removing variables with &gt;50% missing values</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Removing variables with &gt;50% missing values <span style="color: #B2B2B2;">[20ms]</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Imputing missing values</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Sample size &lt;= 30, using sample minimum imputation</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Imputing missing values<span style="color: #00BB00;">✔</span> Imputing missing values <span style="color: #B2B2B2;">[19ms]</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Aggregating data</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Aggregating data <span style="color: #B2B2B2;">[123ms]</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Normalizing data again</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Detecting batch effects using ANOVA for 263 variables...</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Normalizing data again<span style="color: #00BB00;">✔</span> Batch effect detection completed. 1 out of 263 variables show significant batch effects (p &lt; 0.05).</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Normalizing data again<span style="color: #00BBBB;">ℹ</span> Batch effects detected in 0.4% of variables (&lt;=10%). Skipping batch correction.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Normalizing data again<span style="color: #00BB00;">✔</span> Normalizing data again <span style="color: #B2B2B2;">[645ms]</span></span></span></code></pre></div>
<p><strong>That’s it!</strong> Your data is now preprocessed and ready
for analysis! 🎉</p>
</div>
<div class="section level3">
<h3 id="but-wait-what-just-happened-the-science-behind-the-magic">But Wait, What Just Happened? The Science Behind the Magic<a class="anchor" aria-label="anchor" href="#but-wait-what-just-happened-the-science-behind-the-magic"></a>
</h3>
<p><code><a href="../reference/auto_clean.html">auto_clean()</a></code> isn’t actually magic (sorry to disappoint)
– it’s a carefully designed intelligent pipeline that:</p>
<ul>
<li>
<strong>Analyzes your data</strong>: Checks experiment type, sample
size, and metadata</li>
<li>
<strong>Selects optimal methods</strong>: Chooses the best
preprocessing strategy for your specific dataset</li>
<li>
<strong>Executes the pipeline</strong>: Runs everything in the
optimal order</li>
</ul>
<p>Here’s the complete workflow (and yes, it’s impressively
comprehensive):</p>
<p><img src="workflow.png" width="40%" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="the-pipeline-approach-chaining-operations-like-a-pro">The Pipeline Approach: Chaining Operations Like a Pro 🔗<a class="anchor" aria-label="anchor" href="#the-pipeline-approach-chaining-operations-like-a-pro"></a>
</h2>
<p>Before we dive into individual steps, let’s talk about a powerful R
technique: <strong>piping</strong>! You can use either the native pipe
operator <code>|&gt;</code> (R ≥ 4.1.0) or the magrittr pipe
<code>%&gt;%</code> to chain preprocessing operations together. This
makes your code more readable and your workflow more elegant.</p>
<p>Here’s how <code><a href="../reference/auto_clean.html">auto_clean()</a></code> works under the hood for our
glycoproteomics data, written as a manual pipeline:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The complete glycoproteomics preprocessing pipeline</span></span>
<span><span class="co"># This is essentially what auto_clean() does automatically!</span></span>
<span><span class="va">cleaned_exp</span> <span class="op">&lt;-</span> <span class="va">exp</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/normalize_median.html">normalize_median</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span>                       <span class="co"># Step 1: Initial normalization</span></span>
<span>  <span class="fu"><a href="../reference/remove_missing_variables.html">remove_missing_variables</a></span><span class="op">(</span>prop <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">|&gt;</span>     <span class="co"># Step 2: Remove variables with &gt;50% missing</span></span>
<span>  <span class="fu"><a href="../reference/impute_sample_min.html">impute_sample_min</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span>                      <span class="co"># Step 3: Impute missing values (for small datasets)</span></span>
<span>  <span class="fu"><a href="../reference/aggregate.html">aggregate</a></span><span class="op">(</span>to_level <span class="op">=</span> <span class="st">"gfs"</span><span class="op">)</span> <span class="op">|&gt;</span>              <span class="co"># Step 4: Aggregate to glycoform level</span></span>
<span>  <span class="fu"><a href="../reference/normalize_median.html">normalize_median</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span>                       <span class="co"># Step 5: Re-normalize after aggregation</span></span>
<span>  <span class="fu"><a href="../reference/correct_batch_effect.html">correct_batch_effect</a></span><span class="op">(</span><span class="op">)</span>                      <span class="co"># Step 6: Correct batch effects (if batch column exists)</span></span></code></pre></div>
<p><strong>Why use pipes?</strong></p>
<ul>
<li>
<strong>Cleaner code</strong>: No need for intermediate
variables</li>
<li>
<strong>Logical flow</strong>: Operations read left-to-right,
top-to-bottom</li>
<li>
<strong>Fewer errors</strong>: Less chance of mixing up variable
names</li>
<li>
<strong>Easy experimentation</strong>: Simply comment out or modify
steps</li>
</ul>
<p><strong>Pro Tips for Pipeline Usage:</strong></p>
<ul>
<li>Use <code>|&gt;</code> for new R versions (≥ 4.1.0) or
<code>%&gt;%</code> for older versions</li>
<li>Break long pipelines across multiple lines for readability</li>
<li>Comment each step to document your reasoning</li>
<li>Save intermediate results when debugging:
<code>intermediate_result &lt;- exp |&gt; step1() |&gt; step2()</code>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="taking-the-scenic-route-step-by-step-preprocessing">Taking the Scenic Route: Step-by-Step Preprocessing 🚶‍♀️<a class="anchor" aria-label="anchor" href="#taking-the-scenic-route-step-by-step-preprocessing"></a>
</h2>
<p>While <code><a href="../reference/auto_clean.html">auto_clean()</a></code> is fantastic for getting started,
you’ll eventually want more control over your preprocessing pipeline.
Let’s explore each step individually – think of it as learning to cook
rather than just ordering takeout!</p>
<div class="section level3">
<h3 id="step-1-normalization-getting-everyone-on-the-same-page">Step 1: Normalization – Getting Everyone on the Same Page 📏<a class="anchor" aria-label="anchor" href="#step-1-normalization-getting-everyone-on-the-same-page"></a>
</h3>
<p>Imagine you’re comparing heights of people measured in different
units – some in feet, some in meters, some in furlongs (okay, maybe not
furlongs). Normalization does the same thing for your omics data,
bringing all intensities to a comparable scale.</p>
<p><strong>What <code><a href="../reference/auto_clean.html">auto_clean()</a></code> does:</strong></p>
<ul>
<li>
<strong>Glycoproteomics data</strong>: Median normalization</li>
<li>
<strong>Glycomics data</strong>: Median quotient normalization
followed by total area normalization</li>
</ul>
<p><strong>Available normalization methods in
<code>glyclean</code>:</strong></p>
<table class="table">
<colgroup>
<col width="30%">
<col width="39%">
<col width="30%">
</colgroup>
<thead><tr class="header">
<th>Function</th>
<th>Description</th>
<th>Best For</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code><a href="../reference/normalize_median.html">normalize_median()</a></code></td>
<td>Median-based normalization</td>
<td>General use, robust to outliers</td>
</tr>
<tr class="even">
<td><code><a href="../reference/normalize_median_abs.html">normalize_median_abs()</a></code></td>
<td>Median absolute deviation</td>
<td>When you need extra robustness</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/normalize_median_quotient.html">normalize_median_quotient()</a></code></td>
<td>Median quotient method</td>
<td>Compositional data</td>
</tr>
<tr class="even">
<td><code><a href="../reference/normalize_quantile.html">normalize_quantile()</a></code></td>
<td>Quantile normalization</td>
<td>When you want identical distributions</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/normalize_total_area.html">normalize_total_area()</a></code></td>
<td>Total area normalization</td>
<td>Relative abundance data</td>
</tr>
<tr class="even">
<td><code><a href="../reference/normalize_rlr.html">normalize_rlr()</a></code></td>
<td>Robust linear regression</td>
<td>Complex batch designs</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/normalize_rlrma.html">normalize_rlrma()</a></code></td>
<td>Robust linear regression with median adjustment</td>
<td>Complex batch designs</td>
</tr>
<tr class="even">
<td><code><a href="../reference/normalize_rlrmacyc.html">normalize_rlrmacyc()</a></code></td>
<td>Robust linear regression with median adjustment and cyclic
smoothing</td>
<td>Complex batch designs</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/normalize_loessf.html">normalize_loessf()</a></code></td>
<td>LOESS with feature smoothing</td>
<td>Non-linear trends</td>
</tr>
<tr class="even">
<td><code><a href="../reference/normalize_loesscyc.html">normalize_loesscyc()</a></code></td>
<td>LOESS with cyclic smoothing</td>
<td>Cyclic data</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/normalize_vsn.html">normalize_vsn()</a></code></td>
<td>Variance stabilizing normalization</td>
<td>Heteroscedastic data</td>
</tr>
</tbody>
</table>
<p><strong>Pro Tip:</strong> Notice the <code>by</code> parameter in
many functions? This allows stratified normalization within groups –
super useful when you have distinct experimental conditions!</p>
<p>Here we do the median normalization manually:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">normed_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/normalize_median.html">normalize_median</a></span><span class="op">(</span><span class="va">exp</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-2-variable-filtering-saying-goodbye-to-the-unreliable">Step 2: Variable Filtering – Saying Goodbye to the Unreliable
🧹<a class="anchor" aria-label="anchor" href="#step-2-variable-filtering-saying-goodbye-to-the-unreliable"></a>
</h3>
<p>Some variables are like that friend who never shows up to plans –
they’re missing most of the time and aren’t very helpful. In omics data,
variables with too many missing values are often more noise than
signal.</p>
<p><strong>What <code><a href="../reference/auto_clean.html">auto_clean()</a></code> does:</strong> Removes
variables with &gt;50% missing values</p>
<p><strong>Manual approach (do it differently):</strong></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">filtered_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/remove_missing_variables.html">remove_missing_variables</a></span><span class="op">(</span><span class="va">normed_exp</span>, n <span class="op">=</span> <span class="fl">0</span>, by <span class="op">=</span> <span class="st">"group"</span>, strict <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>This code translates to: “Keep any variable that has complete data in
at least one biological group.” Perfect for maximizing the number of
glycopeptides retained!</p>
</div>
<div class="section level3">
<h3 id="step-3-imputation-filling-in-the-blanks-intelligently">Step 3: Imputation – Filling in the Blanks Intelligently 🔮<a class="anchor" aria-label="anchor" href="#step-3-imputation-filling-in-the-blanks-intelligently"></a>
</h3>
<p>Here’s where things get scientifically interesting! Missing values in
mass spectrometry aren’t randomly distributed – they follow patterns
based on the physics and chemistry of the measurement process.</p>
<p><strong>The Science:</strong> Missing values are typically “Missing
At Random” (MAR), meaning they’re related to the intensity of the
signal. Low-abundance ions are more likely to be missed, either due to
poor ionization efficiency or because they fall below the detection
threshold.</p>
<p><strong>What <code><a href="../reference/auto_clean.html">auto_clean()</a></code> does (intelligently based on
sample size):</strong></p>
<ul>
<li>
<strong>Small studies (≤30 samples)</strong>: Sample minimum
imputation (ultra-robust)</li>
<li>
<strong>Medium studies (30-100 samples)</strong>: Minimum
probability imputation (statistically principled)</li>
<li>
<strong>Large studies (&gt;100 samples)</strong>: MissForest
imputation (machine learning power)</li>
</ul>
<p><strong>Your imputation toolkit:</strong></p>
<table class="table">
<colgroup>
<col width="35%">
<col width="28%">
<col width="35%">
</colgroup>
<thead><tr class="header">
<th>Function</th>
<th>Method</th>
<th>Best For</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code><a href="../reference/impute_zero.html">impute_zero()</a></code></td>
<td>Replace with zeros</td>
<td>Quick and simple</td>
</tr>
<tr class="even">
<td><code><a href="../reference/impute_sample_min.html">impute_sample_min()</a></code></td>
<td>Sample minimum values</td>
<td>Small datasets</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/impute_half_sample_min.html">impute_half_sample_min()</a></code></td>
<td>Half of sample minimum</td>
<td>Conservative approach</td>
</tr>
<tr class="even">
<td><code><a href="../reference/impute_min_prob.html">impute_min_prob()</a></code></td>
<td>Probabilistic minimum</td>
<td>Medium datasets</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/impute_miss_forest.html">impute_miss_forest()</a></code></td>
<td>Random Forest ML</td>
<td>Large datasets</td>
</tr>
<tr class="even">
<td><code><a href="../reference/impute_bpca.html">impute_bpca()</a></code></td>
<td>Bayesian PCA</td>
<td>High correlation structure</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/impute_ppca.html">impute_ppca()</a></code></td>
<td>Probabilistic PCA</td>
<td>Linear relationships</td>
</tr>
<tr class="even">
<td><code><a href="../reference/impute_sw_knn.html">impute_sw_knn()</a></code></td>
<td>K-nearest neighbors (Sample-wise)</td>
<td>Local similarity patterns</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/impute_fw_knn.html">impute_fw_knn()</a></code></td>
<td>K-nearest neighbors (Feature-wise)</td>
<td>Local similarity patterns</td>
</tr>
<tr class="even">
<td><code><a href="../reference/impute_svd.html">impute_svd()</a></code></td>
<td>Singular value decomposition</td>
<td>High correlation structure</td>
</tr>
</tbody>
</table>
<p>For demonstration, let’s use the simple zero imputation:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">imputed_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/impute_zero.html">impute_zero</a></span><span class="op">(</span><span class="va">filtered_exp</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-4-aggregation-from-peptides-to-glycoforms">Step 4: Aggregation – From Peptides to Glycoforms 🔄<a class="anchor" aria-label="anchor" href="#step-4-aggregation-from-peptides-to-glycoforms"></a>
</h3>
<p>Here’s where glycoproteomics gets uniquely challenging! Search
engines typically report results at the PSM or peptide level, but what
we really care about are <strong>glycoforms</strong> – the specific
glycan structures attached to specific protein sites.</p>
<p><strong>The Problem:</strong> One glycoform can appear multiple times
in your data due to:</p>
<ul>
<li>Different charge states</li>
<li>Post-translational modifications</li>
<li>Missed protease cleavages</li>
<li>Different peptide sequences covering the same site</li>
</ul>
<p><strong>The Solution:</strong> Intelligent aggregation!</p>
<p><strong>Aggregation levels available:</strong></p>
<ul>
<li>
<strong>“gps”</strong>: Glycopeptides with structures (most
detailed)</li>
<li>
<strong>“gp”</strong>: Glycopeptides with compositions</li>
<li>
<strong>“gfs”</strong>: Glycoforms with structures (recommended
default)</li>
<li>
<strong>“gf”</strong>: Glycoforms with compositions (most
condensed)</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aggregated_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aggregate.html">aggregate</a></span><span class="op">(</span><span class="va">imputed_exp</span>, to_level <span class="op">=</span> <span class="st">"gf"</span><span class="op">)</span></span></code></pre></div>
<p><strong>Pro move:</strong> Re-normalize after aggregation to account
for the new intensity distributions:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aggregated_exp2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/normalize_median.html">normalize_median</a></span><span class="op">(</span><span class="va">aggregated_exp</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-5-batch-effect-correction-harmonizing-your-orchestra">Step 5: Batch Effect Correction – Harmonizing Your Orchestra 🎼<a class="anchor" aria-label="anchor" href="#step-5-batch-effect-correction-harmonizing-your-orchestra"></a>
</h3>
<p>Batch effects are the “different violinists playing the same piece”
problem of omics data. Even when following identical protocols, subtle
differences in instruments, reagents, or environmental conditions can
introduce systematic bias.</p>
<p><strong>The Good News:</strong> If your experimental design is
well-controlled (conditions distributed across batches), batch effect
correction can work wonders!</p>
<p><strong>What <code><a href="../reference/auto_clean.html">auto_clean()</a></code> does:</strong> Automatically
detects and corrects batch effects when it finds a “batch” column in
your sample metadata.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">corrected_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/correct_batch_effect.html">correct_batch_effect</a></span><span class="op">(</span><span class="va">aggregated_exp2</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Batch effect correction completed using ComBat algorithm.</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="mission-accomplished">🎉 Mission Accomplished!<a class="anchor" aria-label="anchor" href="#mission-accomplished"></a>
</h3>
<p>Congratulations! You now have beautifully preprocessed,
analysis-ready glycoproteomics data. Your data has been normalized,
filtered, imputed, aggregated, and batch-corrected – it’s ready to
reveal its biological secrets!</p>
</div>
</div>
<div class="section level2">
<h2 id="whats-next">What’s Next?<a class="anchor" aria-label="anchor" href="#whats-next"></a>
</h2>
<p>With your clean data in hand, you’re ready to dive into the exciting
world of glyco-omics analysis:</p>
<ul>
<li>
<strong>Differential analysis</strong>: Find glycans that change
between conditions</li>
<li>
<strong>Pathway analysis</strong>: Understand biological
processes</li>
<li>
<strong>Machine learning</strong>: Build predictive models</li>
<li>
<strong>Visualization</strong>: Create stunning plots that tell your
data’s story</li>
</ul>
<p>The <code>glycoverse</code> ecosystem has tools for all of these and
more!</p>
</div>
<div class="section level2">
<h2 id="session-info">Session Info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.5.1 (2025-06-13)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 24.04.2 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] glyexp_0.5.1   glyread_0.2.0  glyclean_0.3.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] tidyselect_1.2.1        dplyr_1.1.4             farver_2.1.2           </span></span>
<span><span class="co">#&gt;  [4] blob_1.2.4              Biostrings_2.76.0       fastmap_1.2.0          </span></span>
<span><span class="co">#&gt;  [7] XML_3.99-0.18           digest_0.6.37           lifecycle_1.0.4        </span></span>
<span><span class="co">#&gt; [10] survival_3.8-3          statmod_1.5.0           KEGGREST_1.48.0        </span></span>
<span><span class="co">#&gt; [13] RSQLite_2.4.1           magrittr_2.0.3          genefilter_1.90.0      </span></span>
<span><span class="co">#&gt; [16] compiler_4.5.1          rlang_1.1.6             sass_0.4.10            </span></span>
<span><span class="co">#&gt; [19] tools_4.5.1             igraph_2.1.4            utf8_1.2.6             </span></span>
<span><span class="co">#&gt; [22] yaml_2.3.10             knitr_1.50              bit_4.6.0              </span></span>
<span><span class="co">#&gt; [25] RColorBrewer_1.1-3      BiocParallel_1.42.1     withr_3.0.2            </span></span>
<span><span class="co">#&gt; [28] purrr_1.0.4             BiocGenerics_0.54.0     desc_1.4.3             </span></span>
<span><span class="co">#&gt; [31] grid_4.5.1              stats4_4.5.1            xtable_1.8-4           </span></span>
<span><span class="co">#&gt; [34] edgeR_4.6.2             scales_1.4.0            cli_3.6.5              </span></span>
<span><span class="co">#&gt; [37] rmarkdown_2.29          crayon_1.5.3            ragg_1.4.0             </span></span>
<span><span class="co">#&gt; [40] generics_0.1.4          glyparse_0.1.1          httr_1.4.7             </span></span>
<span><span class="co">#&gt; [43] tzdb_0.5.0              DBI_1.2.3               cachem_1.1.0           </span></span>
<span><span class="co">#&gt; [46] stringr_1.5.1           splines_4.5.1           parallel_4.5.1         </span></span>
<span><span class="co">#&gt; [49] AnnotationDbi_1.70.0    XVector_0.48.0          matrixStats_1.5.0      </span></span>
<span><span class="co">#&gt; [52] vctrs_0.6.5             Matrix_1.7-3            jsonlite_2.0.0         </span></span>
<span><span class="co">#&gt; [55] sva_3.56.0              IRanges_2.42.0          hms_1.1.3              </span></span>
<span><span class="co">#&gt; [58] S4Vectors_0.46.0        bit64_4.6.0-1           glyrepr_0.4.3          </span></span>
<span><span class="co">#&gt; [61] systemfonts_1.2.3       locfit_1.5-9.12         limma_3.64.1           </span></span>
<span><span class="co">#&gt; [64] tidyr_1.3.1             jquerylib_0.1.4         annotate_1.86.0        </span></span>
<span><span class="co">#&gt; [67] glue_1.8.0              rstackdeque_1.1.1       pkgdown_2.1.3          </span></span>
<span><span class="co">#&gt; [70] codetools_0.2-20        stringi_1.8.7           GenomeInfoDb_1.44.0    </span></span>
<span><span class="co">#&gt; [73] UCSC.utils_1.4.0        tibble_3.3.0            pillar_1.10.2          </span></span>
<span><span class="co">#&gt; [76] htmltools_0.5.8.1       GenomeInfoDbData_1.2.14 R6_2.6.1               </span></span>
<span><span class="co">#&gt; [79] textshaping_1.0.1       lattice_0.22-7          vroom_1.6.5            </span></span>
<span><span class="co">#&gt; [82] evaluate_1.0.4          Biobase_2.68.0          readr_2.1.5            </span></span>
<span><span class="co">#&gt; [85] png_0.1-8               backports_1.5.0         memoise_2.0.1          </span></span>
<span><span class="co">#&gt; [88] bslib_0.9.0             nlme_3.1-168            checkmate_2.3.2        </span></span>
<span><span class="co">#&gt; [91] mgcv_1.9-3              xfun_0.52               fs_1.6.6               </span></span>
<span><span class="co">#&gt; [94] MatrixGenerics_1.20.0   pkgconfig_2.0.3</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bin Fu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
