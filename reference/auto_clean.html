<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Automatic Data Preprocessing — auto_clean • glyclean</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Automatic Data Preprocessing — auto_clean"><meta name="description" content="Perform automatic data preprocessing on glycoproteomics or glycomics data.
This function applies an intelligent preprocessing pipeline that includes
normalization, missing value handling, imputation, aggregation (for
glycoproteomics data), and batch effect correction.
For glycomics data, this function calls these functions in sequence:
auto_remove()
auto_normalize()
normalize_total_area()
auto_impute()
auto_correct_batch_effect()


For glycoproteomics data, this function calls these functions in sequence:
auto_normalize()
auto_remove()
auto_impute()
auto_aggregate()
auto_normalize()
auto_correct_batch_effect()

"><meta property="og:description" content="Perform automatic data preprocessing on glycoproteomics or glycomics data.
This function applies an intelligent preprocessing pipeline that includes
normalization, missing value handling, imputation, aggregation (for
glycoproteomics data), and batch effect correction.
For glycomics data, this function calls these functions in sequence:
auto_remove()
auto_normalize()
normalize_total_area()
auto_impute()
auto_correct_batch_effect()


For glycoproteomics data, this function calls these functions in sequence:
auto_normalize()
auto_remove()
auto_impute()
auto_aggregate()
auto_normalize()
auto_correct_batch_effect()

"><meta property="og:image" content="https://glycoverse.github.io/glyclean/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">glyclean</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.10.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/glyclean.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Automatic Data Preprocessing</h1>

      <div class="d-none name"><code>auto_clean.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Perform automatic data preprocessing on glycoproteomics or glycomics data.
This function applies an intelligent preprocessing pipeline that includes
normalization, missing value handling, imputation, aggregation (for
glycoproteomics data), and batch effect correction.</p>
<p>For glycomics data, this function calls these functions in sequence:</p><ul><li><p><code><a href="auto_remove.html">auto_remove()</a></code></p></li>
<li><p><code><a href="auto_normalize.html">auto_normalize()</a></code></p></li>
<li><p><code><a href="normalize_total_area.html">normalize_total_area()</a></code></p></li>
<li><p><code><a href="auto_impute.html">auto_impute()</a></code></p></li>
<li><p><code><a href="auto_correct_batch_effect.html">auto_correct_batch_effect()</a></code></p></li>
</ul><p>For glycoproteomics data, this function calls these functions in sequence:</p><ul><li><p><code><a href="auto_normalize.html">auto_normalize()</a></code></p></li>
<li><p><code><a href="auto_remove.html">auto_remove()</a></code></p></li>
<li><p><code><a href="auto_impute.html">auto_impute()</a></code></p></li>
<li><p><code><a href="auto_aggregate.html">auto_aggregate()</a></code></p></li>
<li><p><code><a href="auto_normalize.html">auto_normalize()</a></code></p></li>
<li><p><code><a href="auto_correct_batch_effect.html">auto_correct_batch_effect()</a></code></p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">auto_clean</span><span class="op">(</span></span>
<span>  <span class="va">exp</span>,</span>
<span>  group_col <span class="op">=</span> <span class="st">"group"</span>,</span>
<span>  batch_col <span class="op">=</span> <span class="st">"batch"</span>,</span>
<span>  qc_name <span class="op">=</span> <span class="st">"QC"</span>,</span>
<span>  normalize_to_try <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  impute_to_try <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  remove_preset <span class="op">=</span> <span class="st">"discovery"</span>,</span>
<span>  batch_prop_threshold <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>  check_batch_confounding <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  batch_confounding_threshold <span class="op">=</span> <span class="fl">0.4</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-exp">exp<a class="anchor" aria-label="anchor" href="#arg-exp"></a></dt>
<dd><p>A <code><a href="https://glycoverse.github.io/glyexp/reference/experiment.html" class="external-link">glyexp::experiment()</a></code> containing glycoproteomics or
glycomics data.</p></dd>


<dt id="arg-group-col">group_col<a class="anchor" aria-label="anchor" href="#arg-group-col"></a></dt>
<dd><p>The column name in sample_info for groups. Default is "group".
Can be NULL when no group information is available.</p></dd>


<dt id="arg-batch-col">batch_col<a class="anchor" aria-label="anchor" href="#arg-batch-col"></a></dt>
<dd><p>The column name in sample_info for batches. Default is "batch".
Can be NULL when no batch information is available.</p></dd>


<dt id="arg-qc-name">qc_name<a class="anchor" aria-label="anchor" href="#arg-qc-name"></a></dt>
<dd><p>The name of QC samples in the <code>group_col</code> column. Default is "QC".
Only used when <code>group_col</code> is not NULL.</p></dd>


<dt id="arg-normalize-to-try">normalize_to_try<a class="anchor" aria-label="anchor" href="#arg-normalize-to-try"></a></dt>
<dd><p>Normalization functions to try. A list. Default includes:</p><ul><li><p><code><a href="normalize_median.html">normalize_median()</a></code>: median normalization</p></li>
<li><p><code><a href="normalize_median_abs.html">normalize_median_abs()</a></code>: absolute median normalization</p></li>
<li><p><code><a href="normalize_total_area.html">normalize_total_area()</a></code>: total area mormalization</p></li>
<li><p><code><a href="normalize_quantile.html">normalize_quantile()</a></code>: quantile normalization</p></li>
<li><p><code><a href="normalize_loessf.html">normalize_loessf()</a></code>: LoessF normalization</p></li>
<li><p><code><a href="normalize_loesscyc.html">normalize_loesscyc()</a></code>: LoessCyc normalization</p></li>
<li><p><code><a href="normalize_rlr.html">normalize_rlr()</a></code>: RLR normalization</p></li>
<li><p><code><a href="normalize_rlrma.html">normalize_rlrma()</a></code>: RLRMA normalization</p></li>
<li><p><code><a href="normalize_rlrmacyc.html">normalize_rlrmacyc()</a></code>: RLRMAcyc normalization</p></li>
</ul></dd>


<dt id="arg-impute-to-try">impute_to_try<a class="anchor" aria-label="anchor" href="#arg-impute-to-try"></a></dt>
<dd><p>Imputation functions to try. A list. Default includes:</p><ul><li><p><code><a href="impute_zero.html">impute_zero()</a></code>: zero imputation</p></li>
<li><p><code><a href="impute_sample_min.html">impute_sample_min()</a></code>: sample-wise minimum imputation</p></li>
<li><p><code><a href="impute_half_sample_min.html">impute_half_sample_min()</a></code>: half sample-wise minimum imputation</p></li>
<li><p><code><a href="impute_sw_knn.html">impute_sw_knn()</a></code>: sample-wise KNN imputation</p></li>
<li><p><code><a href="impute_fw_knn.html">impute_fw_knn()</a></code>: feature-wise KNN imputation</p></li>
<li><p><code><a href="impute_bpca.html">impute_bpca()</a></code>: BPCA imputation</p></li>
<li><p><code><a href="impute_ppca.html">impute_ppca()</a></code>: PPCA imputation</p></li>
<li><p><code><a href="impute_svd.html">impute_svd()</a></code>: SVD imputation</p></li>
<li><p><code><a href="impute_min_prob.html">impute_min_prob()</a></code>: minimum probability imputation</p></li>
<li><p><code><a href="impute_miss_forest.html">impute_miss_forest()</a></code>: MissForest imputation</p></li>
</ul></dd>


<dt id="arg-remove-preset">remove_preset<a class="anchor" aria-label="anchor" href="#arg-remove-preset"></a></dt>
<dd><p>The preset for removing variables. Default is "discovery".
Available presets:</p><ul><li><p>"simple": remove variables with more than 50% missing values.</p></li>
<li><p>"discovery": more lenient, remove variables with more than 80% missing values,
but ensure less than 50% of missing values in at least one group.</p></li>
<li><p>"biomarker": more strict, remove variables with more than 40% missing values,
and ensure less than 60% of missing values in all groups.</p></li>
</ul></dd>


<dt id="arg-batch-prop-threshold">batch_prop_threshold<a class="anchor" aria-label="anchor" href="#arg-batch-prop-threshold"></a></dt>
<dd><p>The proportion of variables that must show significant batch effects to perform batch correction.
Default is 0.3 (30%).</p></dd>


<dt id="arg-check-batch-confounding">check_batch_confounding<a class="anchor" aria-label="anchor" href="#arg-check-batch-confounding"></a></dt>
<dd><p>Whether to check for confounding between batch and group variables.
Default to TRUE.</p></dd>


<dt id="arg-batch-confounding-threshold">batch_confounding_threshold<a class="anchor" aria-label="anchor" href="#arg-batch-confounding-threshold"></a></dt>
<dd><p>The threshold for Cramer's V to consider batch and group variables highly confounded.
Only used when <code>check_batch_confounding</code> is TRUE. Default to 0.4.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A modified <code><a href="https://glycoverse.github.io/glyexp/reference/experiment.html" class="external-link">glyexp::experiment()</a></code> object.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="auto_normalize.html">auto_normalize()</a></code>, <code><a href="auto_remove.html">auto_remove()</a></code>, <code><a href="auto_impute.html">auto_impute()</a></code>, <code><a href="auto_aggregate.html">auto_aggregate()</a></code>, <code><a href="auto_correct_batch_effect.html">auto_correct_batch_effect()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://glycoverse.github.io/glyexp/" class="external-link">glyexp</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">exp</span> <span class="op">&lt;-</span> <span class="va">real_experiment</span></span></span>
<span class="r-in"><span><span class="fu">auto_clean</span><span class="op">(</span><span class="va">exp</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ── <span style="font-weight: bold;">Normalizing data</span> ──</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> No QC samples found. Using default normalization method based on experiment type.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Experiment type is <span style="color: #0000BB;">"glycoproteomics"</span>. Using `normalize_median()`.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Normalization completed.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ── <span style="font-weight: bold;">Removing variables with too many missing values</span> ──</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> No QC samples found. Using all samples.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Applying preset <span style="color: #0000BB;">"discovery"</span>...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Total removed: <span style="color: #0000BB;">24</span> (<span style="color: #0000BB;">0.56</span>%) variables.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Variable removal completed.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ── <span style="font-weight: bold;">Imputing missing values</span> ──</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> No QC samples found. Using default imputation method based on sample size.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Sample size &lt;= 30, using `impute_sample_min()`.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Imputation completed.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ── <span style="font-weight: bold;">Aggregating data</span> ──</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Aggregating to <span style="color: #0000BB;">"gfs"</span> level</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Aggregation completed.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ── <span style="font-weight: bold;">Normalizing data again</span> ──</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> No QC samples found. Using default normalization method based on experiment type.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Experiment type is <span style="color: #0000BB;">"glycoproteomics"</span>. Using `normalize_median()`.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Normalization completed.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ── <span style="font-weight: bold;">Correcting batch effects</span> ──</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Batch column  not found in sample_info. Skipping batch correction.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Batch correction completed.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Glycoproteomics Experiment</span> <span style="color: #00BBBB;">──────────────────────────────────────────────────</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Expression matrix: <span style="color: #0000BB;">12</span> samples, <span style="color: #0000BB;">3979</span> variables</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Sample information fields: <span style="color: #00BB00;">group</span> <span style="color: #0000BB;">&lt;fct&gt;</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Variable information fields: <span style="color: #00BB00;">protein</span> <span style="color: #0000BB;">&lt;chr&gt;</span>, <span style="color: #00BB00;">glycan_composition</span> <span style="color: #0000BB;">&lt;glyrpr_c&gt;</span>, <span style="color: #00BB00;">glycan_structure</span> <span style="color: #0000BB;">&lt;glyrpr_s&gt;</span>, <span style="color: #00BB00;">protein_site</span> <span style="color: #0000BB;">&lt;int&gt;</span>, <span style="color: #00BB00;">gene</span> <span style="color: #0000BB;">&lt;chr&gt;</span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bin Fu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

