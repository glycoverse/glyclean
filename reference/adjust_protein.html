<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Adjust Protein Expression — adjust_protein • glyclean</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Adjust Protein Expression — adjust_protein"><meta name="description" content='This function adjusts the glycopeptide expression by the protein expression.
In another word, it "strips out" the protein expression from the glycopeptide expression,
so that the expression reflects the glycosylation status only.'><meta property="og:description" content='This function adjusts the glycopeptide expression by the protein expression.
In another word, it "strips out" the protein expression from the glycopeptide expression,
so that the expression reflects the glycosylation status only.'><meta property="og:image" content="https://glycoverse.github.io/glyclean/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">glyclean</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/glyclean.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Adjust Protein Expression</h1>

      <div class="d-none name"><code>adjust_protein.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function adjusts the glycopeptide expression by the protein expression.
In another word, it "strips out" the protein expression from the glycopeptide expression,
so that the expression reflects the glycosylation status only.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">adjust_protein</span><span class="op">(</span><span class="va">exp</span>, <span class="va">pro_expr_mat</span>, method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ratio"</span>, <span class="st">"reg"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'glyexp_experiment'</span></span>
<span><span class="fu">adjust_protein</span><span class="op">(</span><span class="va">exp</span>, <span class="va">pro_expr_mat</span>, method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ratio"</span>, <span class="st">"reg"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Default S3 method</span></span>
<span><span class="fu">adjust_protein</span><span class="op">(</span><span class="va">exp</span>, <span class="va">pro_expr_mat</span>, method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ratio"</span>, <span class="st">"reg"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-exp">exp<a class="anchor" aria-label="anchor" href="#arg-exp"></a></dt>
<dd><p>A <code><a href="https://glycoverse.github.io/glyexp/reference/experiment.html" class="external-link">glyexp::experiment()</a></code> object with "glycoproteomics" type.</p></dd>


<dt id="arg-pro-expr-mat">pro_expr_mat<a class="anchor" aria-label="anchor" href="#arg-pro-expr-mat"></a></dt>
<dd><p>A matrix of protein expression.
Columns are samples, rows are uniprot protein accessions.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>The method to use for protein adjustment.
Either "ratio" or "reg". Default is "ratio".</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code><a href="https://glycoverse.github.io/glyexp/reference/experiment.html" class="external-link">glyexp::experiment()</a></code> object with adjusted protein expression.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>For simplicity, glycopeptide expression is denoted as <code>GP</code>,
and protein expression is denoted as <code>PRO</code>.</p><div class="section">
<h3 id="-ratio-method">"ratio" method<a class="anchor" aria-label="anchor" href="#-ratio-method"></a></h3>


<p><code>GP-adj</code> = (<code>GP</code> / <code>PRO</code>) / (median(<code>GP</code>) / median(<code>PRO</code>))</p>
<p>The first part is to adjust glycopeptide expression by protein expression.
The second part is to rescale the expression to the original scale.</p>
</div>

<div class="section">
<h3 id="-reg-method">"reg" method<a class="anchor" aria-label="anchor" href="#-reg-method"></a></h3>


<p>Use linear regression to remove the protein expression from the glycopeptide expression.
Both glycopeptide and protein expression values are log2-transformed (with +1 to avoid log(0))
before fitting the linear model: log2(GP+1) ~ log2(PRO+1).
The residuals represent the glycosylation-specific signal and are converted back to the
original scale using 2^residuals, ensuring all adjusted values are positive.</p>
<p>In both methods, only glycoproteins identified in both <code>exp</code> and <code>pro_expr_mat</code> will be retained.</p>
</div>

    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bin Fu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

